Hello!

Version 3.0 is approaching release and includes significant changes to the core processing algorithm. These changes
improve consistency and fix long-standing ordering issues, but require careful review due to potential breaking changes
in specific scenarios.

## üîÑ Core Algorithm Changes Requiring Your Attention

### **Processing Order Revolution**

The most significant update: **all elements (placeholders, comments) are now processed in document order of appearance
**, rather than the previous grouped approach (comments first, then inline processors, then placeholders).

**What this means for you:**

- If you had comments and placeholders on the same lines, resolution order will change
- More predictable and intuitive processing flow
- Better support for interdependent elements

### **Custom Processor API Updates**

- **Removal of ParagraphPlaceholder injection** from custom CommentProcessor implementations
- **New hierarchical context system**: Introduction of `ContextTree` and `ContextBranch` for managing resolution
  contexts
- **Context annotation approach**: Comment and tag hooks are now annotated with descriptions of the context to use for
  resolution
- The engine automatically resolves placeholders using the appropriate context when processing elements
- Cleaner separation of concerns

### **Nested Context Resolution and Evaluation Context**

- Introduction of `OfficeStamperEvaluationContext` which powers property/index resolution across nested contexts
  created by `ContextTree`/`ContextBranch`.
- New union accessors: `UnionPropertyAccessor` and `UnionIndexAccessor` (collectively referred to as
  "UnionXxxAccessor") to transparently resolve properties and indexed values across multiple stacked contexts.
- Resolution now walks up the context branch: when a property (or index) cannot be resolved on the current (deepest)
  context, the engine automatically tries the parent context, continuing upward until the root is reached.
    - This enables placeholders inside repeated/nested structures to reference values defined in outer scopes.
    - Shadowing still works: a value defined in a deeper context takes precedence over the same name in outer contexts.
- No configuration change is required to benefit from this; custom processors and templates will automatically use the
  new resolution semantics.

### **API Cleanup**

- **All deprecated methods removed** - please check your migration path
- **Unnecessary setters eliminated** for better immutability
- Streamlined configuration API

## üß™ Who Needs to Pay Special Attention?

### **Minimal Impact**

If you use office-stamper with standard configurations and no custom processors, you likely won't notice significant
changes beyond potential resolution order issues.

### **Critical Testing Required** If You:

- Have custom processors that relied on the placeholder resolver
- Use complex templates with comments and placeholders interacting on the same lines
- Depend on the specific processing order of v2.x

## üìã How to Test the Preview

You can find the PR #609

**Focus your testing on:**

1. Templates with mixed comments and placeholders
2. Custom processor implementations
3. Complex SpEL expressions that might be order-dependent
4. Any edge cases in your document generation

## üìö Migration Guide & Documentation

- To do

## üóìÔ∏è Timeline & Feedback

**Target release date**: December 14, 2025

**Please report:**

- Any feedback related to your use case.
- Any breaking changes in your specific use cases
- Documentation gaps in the migration guide
- Performance regressions or improvements
- Missing functionality from v2.x

Submit feedback via GitHub Issues tagged with `v3-review` or join the discussion directly.

Your expertise is invaluable in ensuring a smooth transition!
