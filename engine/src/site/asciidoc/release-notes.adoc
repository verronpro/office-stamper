= Release Notes
:gh: https://github.com
:os: https://github.com/verronpro/office-stamper
:proj: https://github.com/verronpro/office-stamper/releases/tag

This page provides information about the latest releases of Office-stamper, including new features, bug fixes, and other changes.

== Latest Release

=== {proj}/v3.0.0[v3.0.0]

==== Core Overhaul

* **Processing model overhaul**: The engine now iterates "hooks" (placeholders, inline processors, comments) strictly in document order.
* **New Hook concept**: Each placeholder or comment is treated as a `Hook`.
The iterator walks hooks one by one, allowing for more predictable results.
* **Hierarchical Scopes**: `ContextTree` resolves placeholders along the current branch; unresolved values bubble up to parent scopes.
* **Simplified Comment Processors**: Processors are created per hook and executed once, with a fresh `ProcessorContext`.

==== API Changes

* **Moved API classes**: `PlaceholderHooker`, `CommentHooker`, and `HookRemover` are now public in the `pro.verron.officestamper.api` package.
* **Renamed classes**: `ContextDependent` renamed to `Hook`.
* **Standard configuration**: `OfficeStamperConfigurations.standard()` now includes recommended preprocessors and post-processors by default.
* **Evaluation Context**: `EvaluationContextConfigurer` replaced by `EvaluationContextFactory`.
* **Insert API**: Introduced a new `Insert` API for more flexible content insertion.

==== Dependencies

* Upgrade Java version to 25.
* Spring dependencies bumped to 7.0.2 (when available, currently tracking latest).

== Previous Releases

For information about previous releases, see the link:https://github.com/verronpro/office-stamper/blob/main/RELEASE_NOTES.adoc[full release notes] on GitHub.

== Upgrading

=== From v2.9.0 to v3.0.0

* **Java 25 required**: Ensure your project is running on Java 25 or higher.
* **API Package**: If you were using `PlaceholderHooker`, `CommentHooker`, or `HookRemover` from internal packages, update your imports to `pro.verron.officestamper.api`.
* **Hooks**: The engine now uses a "hook" based processing.
If you have custom processors, they now receive a `ProcessorContext`.
* **Standard Configuration**: `OfficeStamperConfigurations.standard()` now includes preprocessing by default.
You may no longer need `standardWithPreprocessing()`.

=== From v2.8.x to v2.9.0

* MAY (unlikely) BREAK some formatting after a replaceWordWith comment.
* Update your dependencies to the latest versions.

=== From v2.7.x to v2.8.0

* No breaking changes.
* Update your dependencies to the latest versions.

=== From v2.6.x to v2.7.0

* If you were using `Paragraph#getComment()`, you'll need to update your code to handle a Collection instead of an Optional.
* Update your dependencies to the latest versions.

=== From v2.5.x to v2.6.x

* No breaking changes.
* Update your dependencies to the latest versions.

=== From v2.4.x to v2.5.x

* No breaking changes.
* Update your dependencies to the latest versions.

== Reporting Issues

If you encounter any issues with a release, report them on the link:https://github.com/verronpro/office-stamper/issues[GitHub Issues] page.

== Next Steps

* Return to the link:index.html[Documentation Home]
* See the link:contributing.html[Contributing] guide if you want to help improve Office-stamper
